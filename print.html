<!DOCTYPE HTML>
<html lang="zh-cn" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>家中古词.zst</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Table of Content</a></li><li class="chapter-item expanded affix "><li class="part-title">Note</li><li class="chapter-item expanded "><a href="word-list.html">单词表</a></li><li class="chapter-item expanded "><a href="switchy-omega-auto-switch.html">Switchy Omega 的自动切换列表</a></li><li class="chapter-item expanded "><a href="cpp11-call-once-throw-error.html">C++11 的 call-once 函数抛出错误</a></li><li class="chapter-item expanded "><a href="pip-find-local-archives.html">Pip Find Local Archives</a></li><li class="chapter-item expanded "><a href="packages.html">Packages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cmake-cheatsheet.html">Cmake Cheatsheet</a></li><li class="chapter-item expanded "><div>LevelDB</div></li><li class="chapter-item expanded "><a href="rst-tools.html">Rst</a></li><li class="chapter-item expanded "><a href="tar-backup.html">Tar Backup</a></li><li class="chapter-item expanded "><a href="zola-blog.html">Zola Blog</a></li></ol></li><li class="chapter-item expanded "><a href="misc.html">Misc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="note.html">Temporary Note</a></li><li class="chapter-item expanded "><a href="codewars-is-prime.html">CodeVars Is Prime</a></li><li class="chapter-item expanded "><a href="ssh-rsa.html">SSH RSA</a></li></ol></li><li class="chapter-item expanded "><a href="micro-editor.html">micro 编辑器</a></li><li class="chapter-item expanded "><a href="rust-getopt.html">Rust 的 getopt 库</a></li><li class="chapter-item expanded "><div>Rust 的 Deref</div></li><li class="chapter-item expanded "><a href="cryptsetup.html">cryptsetup</a></li><li class="chapter-item expanded affix "><li class="part-title">Journal</li><li class="chapter-item expanded "><div>2021</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">家中古词.zst</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="家中古词zst"><a class="header" href="#家中古词zst">家中古词.zst</a></h1>
<pre><code>(begin ( ) ( ) )

{
    let a 10;
    let b 10;

    (+ a b)
}

(begin
    (let a 10)
    (let b 10)

    (+ a b)
)

(define (name argument)
    ())

fn name argument {
    let a 10;
    let b 11;
    (+ a b)
}
</code></pre>
<!--

## 2022/04/19 周二 晴

- [ ] 阅读 nethack 手册。
- [ ] IHC 模型测试。

## 2022/04/18 周一 晴

- [ ] fix bug: protobuf too large.
- [ ] preprare mdc model test.
- [ ] make sure version of mdc result output.
- [ ] mdc: upgrade merger module and data proto to 2.0.2

## 2022/04/12 周二 晴

- [ ] eget
- [ ] 其他 MDC 有关的 issue
- [ ] 前向大巴车漏检、右侧静止货车漏检，模型检测表现与台架表现不一致。#15229
- [ ] logfacade 的升级。
- [ ] 感知结果延迟导致目标消失。#15236
- [ ] MDC-打包脚本。
- [ ] 确认侧视检测模型的情况。#15162
- [ ] 操作 case 数据集的工具。#15808
- [ ] 软件著作权任务。
- [ ] GPU 版本的 ObjCnn。#15845
  - [ ] 性能优化至 300ms 以内。#15407
- [ ] 对 30 号版本做 profiling。
- [ ] obj-cnn 的接口问题。
  - [ ] 对 data-proto 的依赖。
  - [ ] 目标类型描述。
  - [ ] 对 ROI 的描述。
  - [ ] 拼图描述。
- [ ] 看开课吧的课。


## 2022/04/11 周一 晴

- [x] OA 工作时间汇报。
- [x] Bionic-打包脚本。
- [x] 记录 getopt 库的用法。

## 2022/04/08 周五 晴

## 2022/04/07 周四 晴

腰痛，上午请假。

## 2022/04/02 周六 晴

私人：

- [x] 更新 journal 脚本，变成 notebook 工具。

## 2022/04/01 周五 晴

工作：

- [x] 清理 redmine。

私人：

- [x] 更新 journal 脚本，变成 notebook 工具。
  - [ ] 记录 getopt 库的用法。
  - [x] 添加 -a 选项，不模拟 pager。

## 2022/03/30 周四 晴

工作：

- [x] MDC 版本。
  - [x] 调查 TSR 值错误的问题。
- [x] 合并分支。
- [x] 整理参数，ep30-new 是 1 月 4 日的参数。
- [x] 讨论 data-proto 包的发布问题。

私人：

- [x] 手机送去维修。
  - [x] 买钢化膜和手机壳。
- [x] ZSC 招聘，A 类和 B 类的问题。
- [x] 更新 journal 脚本，变成 notebook 工具。
  - [x] 添加 -a 选项，不模拟 pager。

## 2022/03/30 周三 晴

工作：

- [x] MDC 版本发布。
- [x] 看一些面试题。
- [x] 测试 MDC 的发布包。

## 2022/03/29 周二 晴

工作：

- [x] 讨论模型评测的代码。
- [x] tda4 的数据录制问题：更新了 flowbag 的解析协议。
- [x] 发布 tda4-platform 包。
- [x] 合并 obj-cnn 的 MR。
- [x] MDC 版本。
  - [x] mbuf 更新。
  - [x] 更新 obj-cnn 的版本。
  - [x] data-proto-o 发布 1.3.25 版本
  - [x] mdc-sim 的更新。
  - [x] MDC 的 3D-Box 模块更新。
  - [x] enable-tsr
- [x] 修复 MDC 的启动失败问题。
- [x] 看一些面试题。

私人：

- [x] 跑步。

## 2022/03/22 周二 晴

昨天：

* MDC 的 imread 的问题。
* 诊断系统的工作。
* 讨论 TDA4 的设计接口。
* 了解神经网络设计性的工作，指导 ObjCnn 算子设计。
* 发布了 GraphL 2.0。

今天：

* 诊断系统的工作。
* 讨论 TDA4 的设计接口。
* 了解神经网络设计性的工作，指导 ObjCnn 算子设计。
* 模型评测，与 CQ 讨论接口。
* data-proto 的 2.0.0 版本的包和工具。


## 2022/03/21 周一 晴

* 回到公司办公。
* 完善诊断系统，分析示例。
* 与 CQ 讨论评测接口。
* data-proto 2.0.0 的打包和版本发布。
* 关注新的 MDC 检测模型。

## 2022/03/18 周五 晴

- tda4 的 extraflow 包的支持。
- rcode 的改进。
- data-proto 的打包工作。

## 2022/03/17 周四 晴

- rcode-system 的 error-runtime 部分。rcode 库的 trait 部分修了一个
  BUG。object-perception 的 feature-rcode 分支。
- 学习合众的错误接口。
- XHD，TDA4 的包问题。

## 2022/03/15 周二 晴

- rcode-system 草案。
- 发布 MDC 版本，打包脚本。
- 更新 MDC ZZ 10 日的多合一模型。
- tda4 的小问题。
- frp HIL

## 2022/03/14 周一 晴

今天开始居家办公一周；早上 10 点开会，下午 6 点开会。写日报。OA。TDA4 的 release 包发布到仓库里。H1Z 版本发布。rcode 的设计。profiling MDC 的耗时。TSR 网络。

- MDC 整理 commit，发布和测试，replay。
- flowbag 功能，更新文档。
- 面试题。
- MDC 的网络情况。
- rcode 的错误代码情况。

## 2022/03/09 周三 晴

贴贴。 早上请假 1h。 XD 解码图片。 LG 更新版本。 采集数据，查看 delay 情况。 行人前处理更新。 核酸检测，告诉 LJ 中科的核酸情况。 看一看 emacs 的源代码。getopt(3) 试用。

## 2022/03/08 周二 晴

ObjCnn 支持 Rect、Rect32F、BoxSize、BoxSize32F 等类型。 调查行人的问题，检测没检测到。 MDC 版本工作。

## 2022/03/07 周一 阴

回公司办公。 早上请假 1h。 写日报。 写 OA。 合并振安的 MR。 写了 me-config-stands/use 脚本。 分区，迁移 WSL。 调查车辆行人问题，cls 为 1 时也会漏检。 支持 l2view 的开发问题。 面试。

## 2022/03/01 周二 晴

深蹲 2 天。

## 2022/02/28 周一 晴

昨天开始深蹲计划，完成 1 天。 试着打包一个 model 仓库的 whl。 检查行人漏检和 MDC 的问题。 发布 merger 包。

## 2022/02/25 周五 晴

周報：

- simpelog 的 BUG
- simpelog 支持 DLT
- TDA4 的網絡問題調查
- extraflow
- 打包、編譯、發佈版本工作 object-perception xenial49
- busgo 的改進，支持基於 install 的打包。

寫一寫 ugetopts。 關注一下 dlt-daemon 的實現。

## 2022/02/24 周四 晴

glog-dlt 和 simplelog 支持 dlt。 今天睡到 10:30 才起床。果然這樣的人生更幸福。 昨天的 simplelog 的 BUG，保持了一個對象池，用延遲刪除的方法規避問題，這個方法很壞。

## 2022/02/23 周三 晴

刪除 Logger 會導致其他使用此 Logger 的函數崩潰。 ugetopts 寫到 Parse 部分。 simplelog 的 v2 開發發現了 BUG。 TDA4 的多合一模型修改，TDA4 吐出的輸出順序跟 caffe 不一致。 extraflow 跟 LYX 對其接口，介紹給 ZZQ 和 SCX。

## 2022/02/22 周二 雨

Nothing.

## 2022/02/21 周一 雨

调查 TDA4 的检测问题。 发布 TDA4 的 extraflow 版本。 支持 xenial49 版本的 object-perception。

## 2022/02/19 周五 晴

周会：

- MDC 测试和发版。
- MDC 调查和修复检测问题。
- MDC 集成新的多合一模型，观察它的表现，调查它的异常。
- ObjCnn 支持浮点数的矩形，减小了 CvData 的尺寸；修改 BUG。
- 支持一致性内存环的日志接口。
- 支持额外信息的 libflow 消息。

-->
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>
<p>menace</p>
<ul>
<li>n. 威胁，危险的人物。</li>
<li>v. （正式）威胁，威吓。</li>
<li>nethack - Exploring The Mezes of Menace</li>
</ul>
</li>
<li>
<p>dungeon</p>
<ul>
<li>n. 土牢，地牢。</li>
<li>Dungeons &amp; Dragons (TM) 龙与地下城</li>
</ul>
</li>
<li>
<p>amulet</p>
<ul>
<li>n. 护身符，辟邪的物品。</li>
<li>Amulet of Yendor</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="switchy-omega-的自动切换列表"><a class="header" href="#switchy-omega-的自动切换列表">Switchy Omega 的自动切换列表</a></h1>
<ul>
<li>stackoverflow.com 需要 ajax.googleapis.com</li>
</ul>
<pre><code>[SwitchyOmega Conditions]
@with result

*.stackoverflow.com +proxy
*.github.com +proxy
github.com +proxy
docs.python.org +proxy
*.google.com +proxy
*.googleapis.com +proxy

* +direct
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c11-的-call_once-函数抛出错误"><a class="header" href="#c11-的-call_once-函数抛出错误">C++11 的 call_once 函数抛出错误</a></h1>
<p><a href="https://stackoverflow.com/questions/51584960/stdcall-once-throws-stdsystem-error-unknown-error-1">https://stackoverflow.com/questions/51584960/stdcall-once-throws-stdsystem-error-unknown-error-1</a></p>
<p>C++11 的 call-once 函数可以用来保证一个函数（或者其他可调用对象）只运行一次。</p>
<pre><code>call_once(std::once_flag const &amp;, Callable &amp;&amp;, Arguments&amp;&amp; ...);
</code></pre>
<p>调用的时候需要保证 once-flag 在不同的调用之间共享一个实例。</p>
<p>这个函数是线程安全的，需要系统线程库，例如 pthread。但如果使用了它的目标不链接，往往也可能不会出现链接问题。而是会在运行时出现 system-error。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="让-pip-查找本地的包"><a class="header" href="#让-pip-查找本地的包">让 pip 查找本地的包</a></h1>
<p>如果你有很多 whl 包，而且还有个 nas 盘用来分享包。可以把 whl 包拷贝到 nas 盘的一个目录里：</p>
<pre><code>cp dist/xxxx.whl /mnt/nas/whl/
</code></pre>
<p>然后用 pip 的 -f, --find-links 选项来在这个目录里找包。</p>
<pre><code>pip -f /mnt/nas/whl xxxx
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="packages"><a class="header" href="#packages">Packages</a></h1>
<h2 id="yay"><a class="header" href="#yay">yay</a></h2>
<ul>
<li>acpi</li>
</ul>
<p>ACPI is short for <em>Advanced Configuration and Power Interface</em>. This command will query your battery status.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cmake-速记"><a class="header" href="#cmake-速记">cmake 速记</a></h1>
<h2 id="c-标准"><a class="header" href="#c-标准">C++ 标准</a></h2>
<p>全局设置：</p>
<pre><code>set(CMAKE_CXX_STANDARD 11)
</code></pre>
<p>目标设置：</p>
<pre><code>set_property(TARGET target PROPERTY CXX_STANDARD 14)
</code></pre>
<h2 id="目标不只是库"><a class="header" href="#目标不只是库">目标不只是库</a></h2>
<p>目标除了是库的名字，还包含库的编译和链接参数，以及依赖的编译和链接参数。</p>
<p>全局地增加头文件路径：</p>
<pre><code>include_directories(${INCLUDE_PATH})
</code></pre>
<p>这样会使得所有目标的头文件搜索都增加此路径，除非这是 SDK 提供的头文件路径，否则这样做是结构不良的。应该使用：</p>
<pre><code>target_include_directories(${TARGET} ${SCOPE} ${INCLUDE_PATH})
</code></pre>
<p>这样只会在此目标编译时查找这个路径。</p>
<p>类似的 <code>link_directories</code> 比 <code>include_directories</code> 更加危险，因为头文件路径查找混乱往往是容易发现的，但库查找失败往往是非常隐蔽的。在多数时候都应该用 <code>target_link_directories</code> 代替。</p>
<p>这个命令只有在被链接的是库的名字时才代表链接 C 库，它还可以是一个目标的名字。此时它代表的是此目标依赖对应目标，进而会将依赖目标的公开（PUBLIC）编译属性、路径属性和链接属性传播到被依赖的目标上。达成树形的依赖管理。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="restructuctedtext-的配套工具"><a class="header" href="#restructuctedtext-的配套工具">reStructuctedText 的配套工具</a></h1>
<p>Rst 是个很好的文档格式。</p>
<p>rst2html 将 Rst 转换成 html：</p>
<pre><code>rst2html source.rst target.html
</code></pre>
<p>如果不怕丑，现在可以把 target.html 挂在个人网站上。</p>
<p>rst2man 将 Rst 转换成 man 程序可以读取的格式，我喜欢用它来在终端里阅读 Rst 文档:</p>
<pre><code>local manfile=$(mktemp)
rst2man source.rst $manfile
man $manfile
</code></pre>
<p>rst2pdf 将 Rst 转换成 pdf，可以用来比较正式地发布给其他人看。不过对中文字体的处理永远是个难题，多半需要你指定样式表才能正确渲染中文:</p>
<pre><code>rst2pdf source.rst target.pdf
rst2pdf -s chinese source.rst target.pdf
</code></pre>
<p>上面的 <code>-s chinese</code> 实际上指明了 ~/.rst2pdf/styles/chinese.style：</p>
<pre><code>{ &quot;styles&quot;: { &quot;base&quot;: { &quot;wordWrap&quot;: &quot;CJK&quot; } }
, &quot;fontsAlias&quot;: { &quot;stdFont&quot;: &quot;Source Han Serif&quot; } }
</code></pre>
<p>这个配置只是示例，不保证成功。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tar-的增量备份能力"><a class="header" href="#tar-的增量备份能力">tar 的增量备份能力</a></h1>
<p>备份与还原是相对的。设下面的序号是递增的时间点，朴素的备份还原过程是：</p>
<ol>
<li>备份到文件 1，保存当前所有内容。</li>
<li>备份到文件 2，保存当前所有内容。</li>
<li>备份到文件 3，保存当前所有内容。</li>
<li>从备份文件 1 还原到 1 时刻。</li>
<li>从备份文件 2 还原到 2 时刻。</li>
</ol>
<p>增量备份则在保存之间共享重复的部分：</p>
<ol>
<li>备份到文件 1，保存当前所有内容。</li>
<li>备份到文件 2，保存当前与 1 时刻的区别。</li>
<li>备份到文件 3，保存当前与 2 时刻的区别。</li>
<li>从备份文件 1、2、3 还原到 3 时刻。</li>
<li>从备份文件 1、2 还原到 2 时刻。</li>
</ol>
<p>tar 用 -g 选项支持这种过程。</p>
<ul>
<li>
<p>初次备份：</p>
<pre><code>tar -g snapshot -czf backup0.tar.gz backup/
</code></pre>
</li>
<li>
<p>第二次备份：</p>
<pre><code>tar -g snapshot -czf backup1.tar.gz backup/
</code></pre>
</li>
<li>
<p>第三次备份：</p>
<pre><code>tar -g snapshot -czf backup1.tar.gz backup/
</code></pre>
</li>
</ul>
<p>snapshot 是生成的文件列表文件，它一般情况下都很小。还原需要依次解压所有的包。</p>
<p>如果备份的恢复并不需要恢复到除了最新版本之外的历史版本，也就是如下的流程：</p>
<ol>
<li>备份到文件 1，保存当前所有内容。</li>
<li>备份到文件 1，更新当前与之前时刻的区别。</li>
<li>备份到文件 1，更强当前与之前时刻的区别。</li>
<li>从备份文件 1 还原到 3 时刻。</li>
<li>无法还原到 2 时刻。</li>
</ol>
<p>那么可以使用 tar 的 -u 选项。</p>
<ul>
<li>
<p>初次备份：</p>
<pre><code>tar -cv -f backup.tar.gz backup
</code></pre>
</li>
<li>
<p>之后的备份：</p>
<pre><code>tar -uv -f backup.tar.gz backup
</code></pre>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="zola-网站生成器"><a class="header" href="#zola-网站生成器">zola 网站生成器</a></h1>
<p>Zola 是个 Rust 程序，但是可以用 snap 安装。它是基于 CommonMark 渲染文章成网站的。渲染过程中使用了 Tera 模板引擎。</p>
<p>这个网站选择了 Zola 的 after-dark 主题。</p>
<div style="break-before: page; page-break-before: always;"></div><p>+++
title = &quot;杂记&quot;
date = &quot;3000-01-01&quot;
+++</p>
<h2 id="c-中使用成员克隆函数"><a class="header" href="#c-中使用成员克隆函数">C++ 中使用成员克隆函数</a></h2>
<p>《设计模式》中的【原型模式】认为，克隆一个对象的职责需要交给对象所属的具体类：</p>
<pre><code>class Type {
 public:
  using Self = Type;
  Self Clone() const;

  Type(Type const &amp;) = delete;
  Type &amp;operator=(Type const &amp;) = delete;

  Type(Type &amp;&amp;) = default;
  Type &amp;operator=(Type &amp;&amp;) = default;
};
</code></pre>
<p>对克隆行为比较重要的类来说，删除默认拷贝构造函数和赋值构造函数是不错的。但这种行为会让移动构造和移动赋值函数也被删除，可以再启用它们。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="笔记"><a class="header" href="#笔记">笔记</a></h1>
<h2 id="clang-format-局部关闭格式化"><a class="header" href="#clang-format-局部关闭格式化">Clang-Format 局部关闭格式化</a></h2>
<p>有些时候手动改动的缩进是有语义的，不希望用 clang-format 改变，这时可以用::</p>
<pre><code>// clang-format off
/* Some Code.
With good style. */
// clang-format on
</code></pre>
<h2 id="bash-的笔记"><a class="header" href="#bash-的笔记">Bash 的笔记</a></h2>
<p>测试一个文件存在而且不空::</p>
<pre><code>test -s $FILE
</code></pre>
<h2 id="curl"><a class="header" href="#curl">Curl</a></h2>
<p>执行一个网站上部署的脚本：</p>
<pre><code>curl -fsSL &quot;$URL&quot; | bash
</code></pre>
<pre><code>-f, --fail        在 HTTP 请求错误的时候返回 22
-s, --silent      不显示请求进度条和错误信息
-S, --show-error  在 --slient 的时候也显示错误信息
-L, --location    在服务器返回说被请求的资源移动到了另一个地方，要求 curl 重新发送请求。
</code></pre>
<p>-sS 组合在一起即是“显示错误信息、但不显示进度条”。</p>
<p>https://paste.rs 服务：</p>
<pre><code>curl --data-binary @plain.txt https://paste.rs
echo &quot;Hello&quot; | curl --data-binary @- https://paste.rs
curl -X DELETE &quot;https://paste.rs/$ID&quot;
</code></pre>
<p>--data-binary  指定二进制数据为请求的 Body 部分。用 @ 后跟文件名的方式要求 curl 读取文件，用 @- 要求 curl 读取标准输入。</p>
<pre><code>-X method      指定 HTTP 方法，不指定时为 GET。
</code></pre>
<h2 id="gpg-百度盘"><a class="header" href="#gpg-百度盘">gpg 百度盘</a></h2>
<p><code>gpg/plus7wist-gpg.txt</code> 是密码保护的私钥。下载导入：</p>
<pre><code>gpg --import plus7wist-gpg.txt
# 输入密码
</code></pre>
<h2 id="ffmpeg"><a class="header" href="#ffmpeg">ffmpeg</a></h2>
<h3 id="合并视频"><a class="header" href="#合并视频">合并视频</a></h3>
<p>保存文件 filelist.txt，包含：</p>
<pre><code>file 'input1.mkv'
file 'input2.mkv'
file 'input3.mkv'
</code></pre>
<p>再使用命令：</p>
<pre><code>ffmpeg -f concat -i filelist.txt -c copy output.mkv
</code></pre>
<p>这样就将 inpu1.mkv、input2.mkv 和 input3.mkv 合并成 output.mkv。</p>
<h2 id="vim"><a class="header" href="#vim">Vim</a></h2>
<p>设置括号匹配颜色，在色彩终端里，背景是当前背景，前景是浅蓝：</p>
<pre><code>hi MatchParan ctermbg=bg ctermfg=lightblue
</code></pre>
<h2 id="c"><a class="header" href="#c">C++</a></h2>
<p>子类（<code>D</code>) 要想调用父类（<code>B</code>）的函数（<code>f</code>)，而且 <code>D</code> 重写或者重载了 <code>f</code>，那么子类定义里直接调用 <code>f</code> 会选择子类里的实现。要选择父类的实现，需要用 <code>B::f</code> 这种格式。</p>
<h2 id="git"><a class="header" href="#git">Git</a></h2>
<h3 id="rebase"><a class="header" href="#rebase">Rebase</a></h3>
<p>Rebase 是把当前分支复制一份到目标分支上，就好像当前分支是基于目标分支开始开发的。可能是因为 Rebase 改变了当前开发分支的「基点（base）」，所以才有这个名字。原有的修改不会删除，只是不会被当前分支引用了。</p>
<p>Rebase 当前分支到其与变基目标的最近公共祖先，会拷贝到目标分支末尾。这个过程可能产生冲突，这就需要手动解决。如果这个最近公共祖先正是目标分支，则理解为目标点本身就是当前位置的基点，Rebase 不会有任何作用。如果这个祖先是当前分支，即当前分支是落后于目标的，则理解为当前分支进行了空的提交，把这个空的提交复制到目标后，意味着当前分支移动到了目标分支。</p>
<p>Rebase 动作可能改变：</p>
<ul>
<li>当前分支的位置。</li>
<li>历史提交。</li>
</ul>
<h3 id="修改分支的指向"><a class="header" href="#修改分支的指向">修改分支的指向</a></h3>
<p>下面的命令让 {branch} 分支指向 {commit} 提交。</p>
<pre><code>git branch -f {branch} {commit}
</code></pre>
<h2 id="conan"><a class="header" href="#conan">conan</a></h2>
<h3 id="依照-settings-不同决定依赖"><a class="header" href="#依照-settings-不同决定依赖">依照 settings 不同决定依赖</a></h3>
<p>用 <code>requirements</code> 方法，在其中读取 <code>self.settings</code>，对应调用 <code>self.requires(r)</code> 将 <code>r</code> 设为依赖。</p>
<h2 id="python"><a class="header" href="#python">python</a></h2>
<h3 id="opencv"><a class="header" href="#opencv">opencv</a></h3>
<pre><code>def video_iterator(video_path):
  capture = cv2.VideoCapture(video_path)
  while True:
    ok, image = capture.read()
    if not ok:
      break
    yield image
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="codewars---isprime"><a class="header" href="#codewars---isprime">CodeWars - IsPrime</a></h1>
<h2 id="is-a-number-prime"><a class="header" href="#is-a-number-prime">Is a number prime?</a></h2>
<pre><code>IsPrime :: Integer -&gt; Bool
</code></pre>
<p>判断一个整数是否是整数。假设整数是 N，这个题目只需要 N 的 1/2 次方程度的复杂度
就可以了。</p>
<h2 id="解答"><a class="header" href="#解答">解答</a></h2>
<p>当 x 小于等于 1 时为假，否则检查不大于根号 N 的数中是否有 N 的因子即可。后面这
个过程是迭代过程，可以列表推导来完成：求出 2 到根号 N 中 N 的因子的列表，再判断
这个列表是不是空的。而因为懒求值的性质，这个过程并没有很多 overhead。</p>
<pre><code>isPrime :: Integer -&gt; Bool
isPrime x
  | x &lt;= 1    = False
  | otherwise = null [d | d &lt;- [2..iSqrt x], (mod x d) == 0]

iSqrt :: Integer -&gt; Integer
iSqrt = floor . sqrt . fromInteger
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="没有共同签名"><a class="header" href="#没有共同签名">没有共同签名</a></h1>
<p>我发现我没办法用 ssh 密钥推送和获取 gitee 上的版本库了。当然 https 的校验没有问题，所以不是我账户有什么毛病。我想起可以用 GIT_SSH 告诉 git 使用脚本代替 ssh 命令连接到版本库。我就用它来看看 ssh 的情况：</p>
<pre><code>#!/usr/bin/env bash

# git-ssh
exec ssh -v &quot;$@&quot;
</code></pre>
<p>然后：</p>
<pre><code>GIT_SSH=./git-ssh git clone {some_repo}
</code></pre>
<p>这时 ssh 就打印出了调试信息：</p>
<pre><code>{其他信息}
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering public key: {密钥文件} RSA SHA256:{校验和} explicit
debug1: send_pubkey_test: no mutual signature algorithm
debug1: No more authentication methods to try.
git@gitee.com: Permission denied (publickey).
fatal: 无法读取远程仓库。
</code></pre>
<p>从字面上看，ssh 说「没有共同的签名算法」。查看上面对应的 {密钥文件} 对应的公钥，它的开头是 ssh-rsa，这表示它是基于 SHA-1 哈系的 RSA 密钥，而 SHA-1 已经不再安全了。这个错误可能是 gitee 或者我本机的某一端拒绝使用 ssh-rsa 这个算法了。</p>
<p>因此我也不必再调查是谁拒绝了这个算法，只需要换个更好的算法即可：</p>
<pre><code>ssh-keygen -t ed25519 -f {新密钥文件} -C {我的邮箱}
</code></pre>
<ul>
<li>-t 表示密钥类型（type），ed25519 是一种基于椭圆曲线的加密算法。</li>
<li>-f 表示输出密钥到这个文件（file）。</li>
<li>-C 表示给密钥加个注释（comment）。</li>
</ul>
<p>可以发现 ed25519 的密钥很短，甚至可以背下来 XD。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="micro-编辑器"><a class="header" href="#micro-编辑器">micro 编辑器</a></h1>
<h2 id="存活"><a class="header" href="#存活">存活</a></h2>
<p>micro {FILE} 打开文件，C-q 退出，C-s 保存。C-e 打开命令模式，help 命令打开帮助。</p>
<p>帮助文档会显示在另一个窗口，同时光标会跳转过去，C-w 跳转光标到原来的窗口，再按跳转回去。按方向键移动光标，阅读帮助。</p>
<h2 id="帮助摘要"><a class="header" href="#帮助摘要">帮助摘要</a></h2>
<p>用 help {topic} 查看帮助，topic 有：</p>
<ul>
<li>tutorial</li>
<li>keybindings</li>
<li>defaultkeys</li>
<li>commands</li>
<li>options</li>
<li>plugins</li>
<li>colors</li>
</ul>
<h2 id="教程"><a class="header" href="#教程">教程</a></h2>
<p>这是 help tutorial 的摘要。</p>
<p>配置文件在 ~/.config/micro 里。micro 启动会加载配置文件 settings.json。set 命令会同步修改里面的值。setlocal 则相反，不会修改这个文件。</p>
<p>settings.json 可以用：</p>
<pre><code>{
	&quot;*.rb&quot;: {
		&quot;tabsize&quot;: 2
	}
}
</code></pre>
<p>设置特别文件的选项。bindings.json 是按键绑定配置。bind 命令可以同步修改这个文件。init.lua 文件是 initlua 插件的启动文件。</p>
<h2 id="命令"><a class="header" href="#命令">命令</a></h2>
<p>后缀问号的是可选参数。</p>
<h3 id="按键绑定"><a class="header" href="#按键绑定">按键绑定</a></h3>
<ul>
<li>bind {key} {action}</li>
<li>showkey {key}</li>
</ul>
<h3 id="编辑"><a class="header" href="#编辑">编辑</a></h3>
<ul>
<li>replace {search} {value} {flag}?
<ul>
<li>-a 替换所有</li>
<li>-l 字面替换（literal）而不是正则表达式替换</li>
</ul>
</li>
<li>replaceall {search} {value}</li>
<li>retab：根据选项 tabtospaces，将 tab 和空格之间转换。</li>
<li>textfilter {command}...：把当前选择的文本用命令过滤。</li>
</ul>
<h3 id="文件"><a class="header" href="#文件">文件</a></h3>
<ul>
<li>save {file}?</li>
<li>reload</li>
</ul>
<h3 id="插件"><a class="header" href="#插件">插件</a></h3>
<ul>
<li>plugin list</li>
<li>plugin install {plugin}</li>
<li>plugin remove {plugin}</li>
<li>plugin update {plugin}</li>
<li>plugin avaliable {plugin}</li>
</ul>
<h3 id="选项"><a class="header" href="#选项">选项</a></h3>
<ul>
<li>set {option} {value}</li>
<li>setlocal {option} {value}</li>
<li>show {option}</li>
<li>reset {option}</li>
</ul>
<h3 id="窗格"><a class="header" href="#窗格">窗格</a></h3>
<ul>
<li>vsplit {file}</li>
<li>hsplit {file}</li>
<li>tab {file}</li>
<li>tabmove {n}</li>
<li>tabmove +{n}</li>
<li>tabmove -{n}</li>
<li>tabswitch {tab}</li>
<li>quit</li>
</ul>
<h3 id="命令-1"><a class="header" href="#命令-1">命令</a></h3>
<ul>
<li>run {command}...：后台运行 shell 命令，命令输出会在运行结束后（连接成一行）展示在最下面。</li>
<li>textfilter {command}...：把当前选择的文本用命令过滤。</li>
<li>term {exec}?</li>
</ul>
<h3 id="其他"><a class="header" href="#其他">其他</a></h3>
<ul>
<li>help {topic}?</li>
<li>log：打开历史命令</li>
<li>cd {path}</li>
<li>pwd</li>
<li>raw：打开一个文件，显示所有按键。可以帮助用户确定 micro 捕获了哪些按键（有些快捷键会被终端模拟器或者 shell 捕获）。</li>
</ul>
<h3 id="插件提供"><a class="header" href="#插件提供">插件提供</a></h3>
<ul>
<li>lint：默认插件提供，检查当前文件。</li>
<li>comment：默认插件提供，自动注释。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-的-getopt-库"><a class="header" href="#rust-的-getopt-库">Rust 的 getopt 库</a></h1>
<p>getopt::Parser::new 传入用命令行参数数组和选项定义。Parser 是个迭代器，返回的是一种 Result。利用 Option 在内部值是 Result 的时候有 transpose 方法。所以常见下面的用法：</p>
<pre><code>while let Some(opt) = opts.next().transpose()? {
    // 处理 opt
}
// 没有更多参数了。
</code></pre>
<p>当迭代器返回错误的时候，这段代码会返回此错误。</p>
<p>opt 部分是 getopt::Opt 类型，它不过是 char 和 Option&lt;String&gt; 的元组，表示选项和选项的值（可选）。再根据选项定义处理不同的选项即可。注意参数不足或者未定义选项等错误会在 transpose 处返回，不必在循环中处理，所以选项定义外的分支可以直接调用 unreachable!()。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptsetup"><a class="header" href="#cryptsetup">cryptsetup</a></h1>
<h2 id="wsl2"><a class="header" href="#wsl2">WSL2</a></h2>
<p>首先升级到 Window 11，切换到管理员模式的 PowerShell，插入磁盘，查看磁盘 ID：</p>
<pre><code>GET-CimInstance -query &quot;SELECT * from Win32_DiskDrive&quot;
</code></pre>
<p>第一行的 <code>\\.\PHYSICALDRIVE*</code> 是此磁盘的 ID，挂载到 WSL2。</p>
<pre><code>wsl --mount ${ID} --bare
</code></pre>
<p>因为这个磁盘里没有 Linux 能直接认识的操作系统，所以需要用 --bare 要求它只挂载裸设备。如果顺利，Linux 的终端中就可以看到这个磁盘设备，例如 /dev/sdc 和 /dev/sdc1。</p>
<p>参考：</p>
<ul>
<li><a href="https://devblogs.microsoft.com/commandline/servicing-the-windows-subsystem-for-linux-wsl-2-linux-kernel/">https://devblogs.microsoft.com/commandline/servicing-the-windows-subsystem-for-linux-wsl-2-linux-kernel/</a></li>
<li><a href="https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-mount-disk">https://docs.microsoft.com/zh-cn/windows/wsl/wsl2-mount-disk</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
